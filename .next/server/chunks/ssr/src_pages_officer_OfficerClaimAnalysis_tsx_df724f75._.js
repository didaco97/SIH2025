module.exports=[877565,a=>{"use strict";var b=a.i(187924),c=a.i(757369),d=a.i(523312),e=a.i(546842),f=a.i(596221),g=a.i(124987),h=a.i(170106);let i=(0,h.default)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);var j=a.i(781560),k=a.i(177156),l=a.i(104720),m=a.i(641710),n=a.i(816201),o=a.i(862722);let p=(0,h.default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var q=a.i(699570),r=a.i(580701),s=a.i(631865),t=a.i(572131),u=a.i(823292),v=a.i(269876),w=a.i(591119),x=a.i(977929),y=a.i(786304),z=a.i(238246),A=a.i(50944),B=a.i(222324),C=a.i(711642);let D={lat:20.5937,lng:78.9629},E={width:"100%",height:"100%"};function F(){let a=(0,A.useRouter)(),{user:h}=(0,C.useAuth)(),[F,G]=(0,t.useState)([]),[H,I]=(0,t.useState)(null),[J,K]=(0,t.useState)(!1),[L,M]=(0,t.useState)(null),{claims:N,loading:O}=(0,B.useClaims)({limitCount:50,realtime:!0}),[P,Q]=(0,t.useState)(null),R=N.find(a=>a.id===P),[S,T]=(0,t.useState)(null),[U,V]=(0,t.useState)(null),[W,X]=(0,t.useState)(null),[Y,Z]=(0,t.useState)(!1),$=(0,t.useCallback)(async a=>{if(Q(a.id||null),!L)return;if(a.latitude&&a.longitude){let b={lat:a.latitude,lng:a.longitude};X(b),L.panTo(b),L.setZoom(18),u.toast.success(`Viewing ${a.farmerName}'s farm at exact coordinates`);return}X(null);let b=`${a.village}, ${a.district}, Maharashtra, India`;try{new google.maps.Geocoder().geocode({address:b},(b,c)=>{if("OK"===c&&b&&b[0]){let c=b[0].geometry.location;L.panTo(c),L.setZoom(15),u.toast.info(`Showing approximate location for ${a.village}`)}else u.toast.warning(`Could not locate ${a.village}`)})}catch(a){console.error("Geocoding failed",a)}},[L]);(0,t.useEffect)(()=>{(async()=>{try{let a=await (0,x.getSegmentedFarms)();G(a)}catch(a){console.error("Failed to load farms from Firestore",a)}})()},[]);let _=async()=>{try{let a=await (0,x.getSegmentedFarms)();G(a)}catch(a){console.error("Failed to refresh farms",a)}},{isLoaded:aa}=(0,s.useJsApiLoader)({id:"google-map-script",googleMapsApiKey:"AIzaSyDxjUs4SYfau1jdaywmkgI17ctCs5adFsI"}),ab=(0,t.useCallback)(async a=>{if(!a.latLng)return;if(!h?.uid)return void u.toast.error("Please log in to segment farms");let b=a.latLng.lat(),c=a.latLng.lng();K(!0);try{let a=await fetch("http://localhost:8001/segment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lat:b,lng:c})});if(!a.ok){let b=await a.json();throw Error(b.detail||"Failed to segment")}let d=await a.json();if(!d.features||0===d.features.length)return void u.toast.error("No farm detected at this location");let e=["#4ade80","#facc15","#60a5fa","#f87171","#c084fc","#fb923c"],f=e[Math.floor(Math.random()*e.length)],g=d.features[0]?.properties?.area_m2||0,i=`FARM-${Date.now().toString(36).toUpperCase()}-${Math.floor(1e3*Math.random())}`,j=Math.floor(Math.random()*N.length),k=N.length>0?N[j]:null,l=R||k;console.log(`Segmenting farm: Using ${l?.farmerName||"standalone"} (index ${j})`);let m={claimId:l?.id||"",farmerId:l?.farmerId||i,farmerName:l?.farmerName||`Farm ${i}`,village:l?.village||"Unknown",district:l?.district||"",surveyNo:l?.surveyNumber||"",cropType:l?.cropType||"",color:f,features:d.features,areaM2:g,createdBy:h.uid},n=await (0,x.saveSegmentedFarm)(m);await _(),I(n),l?u.toast.success(`Farm segmented for ${l.farmerName}!`):u.toast.success(`Standalone farm ${i} segmented!`)}catch(a){console.error("Segmentation error:",a),u.toast.error(`Error: ${a.message}`)}finally{K(!1)}},[R,N,h,_]),ac=(0,t.useCallback)(a=>{M(a),a.setMapTypeId("hybrid")},[]),ad=async(a,b)=>{a.stopPropagation();try{await (0,x.deleteSegmentedFarm)(b),G(a=>a.filter(a=>a.id!==b)),T(null),H===b&&I(null),u.toast.success("Farm segment removed")}catch(a){console.error("Failed to delete farm",a),u.toast.error("Failed to delete farm segment")}},ae=()=>F.find(a=>a.id===H);return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)("div",{className:"fixed left-0 top-0 z-40",children:(0,b.jsx)(c.OfficerSidebar,{})}),(0,b.jsxs)("main",{className:"ml-64 p-6 overflow-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground font-display",children:"Claim Analysis"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Multi-farm segmentation and analysis"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(r.Select,{defaultValue:"2023",children:[(0,b.jsx)(r.SelectTrigger,{className:"w-[120px]",children:(0,b.jsx)(r.SelectValue,{})}),(0,b.jsxs)(r.SelectContent,{children:[(0,b.jsx)(r.SelectItem,{value:"2023",children:"2023"}),(0,b.jsx)(r.SelectItem,{value:"2022",children:"2022"})]})]}),(0,b.jsx)(q.Button,{variant:"ghost",size:"icon",className:"relative",children:(0,b.jsx)(d.Bell,{className:"w-5 h-5 text-muted-foreground"})}),(0,b.jsx)(q.Button,{variant:"ghost",size:"icon",className:"bg-secondary",children:(0,b.jsx)(e.User,{className:"w-5 h-5 text-muted-foreground"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 h-[calc(100vh-140px)]",children:[(0,b.jsxs)("div",{className:"lg:col-span-1 flex flex-col gap-4 h-full",children:[(0,b.jsxs)(w.Card,{className:"flex flex-col overflow-hidden shadow-card border-none bg-card h-[30%] shrink-0",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-border bg-muted/30 flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"font-semibold flex items-center gap-2",children:[(0,b.jsx)(l.FileText,{className:"w-4 h-4"})," Recent Claims (",N.length,")"]}),(0,b.jsx)(z.default,{href:"/officer/claims",children:(0,b.jsx)(q.Button,{variant:"ghost",size:"sm",className:"text-xs",children:"View All"})})]}),(0,b.jsx)(v.ScrollArea,{className:"flex-1 p-3",children:O?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)(f.Loader2,{className:"w-5 h-5 animate-spin text-muted-foreground"})}):0===N.length?(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No claims found"}):(0,b.jsx)("div",{className:"space-y-2",children:N.map(a=>{let c="approved"===a.status?(0,b.jsx)(n.CheckCircle,{className:"w-3 h-3 text-green-500"}):"rejected"===a.status?(0,b.jsx)(o.XCircle,{className:"w-3 h-3 text-red-500"}):(0,b.jsx)(m.Clock,{className:"w-3 h-3 text-yellow-500"});return(0,b.jsxs)("div",{onClick:()=>$(a),className:`p-2 rounded-lg border transition-colors cursor-pointer ${P===a.id?"bg-primary/10 border-primary":"border-border bg-background hover:bg-muted/50"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)("span",{className:"font-medium text-xs truncate max-w-[60%]",children:a.farmerName}),(0,b.jsxs)(y.Badge,{variant:"outline",className:"text-[10px] gap-1 px-1.5 py-0",children:[c,a.status]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-[10px] text-muted-foreground",children:[(0,b.jsx)("span",{children:a.lossType}),(0,b.jsxs)("span",{children:[a.area," ",a.areaUnit]})]}),(a.document712Url||a.documents&&a.documents.length>0)&&(0,b.jsxs)("div",{className:"flex gap-2 mt-2 pt-2 border-t border-border/50",children:[a.document712Url&&(0,b.jsxs)("a",{href:a.document712Url,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),className:"flex items-center gap-1 text-[10px] text-primary hover:underline",children:[(0,b.jsx)(l.FileText,{className:"w-3 h-3"}),"7/12 Doc"]}),a.documents&&a.documents.length>0&&(0,b.jsxs)("a",{href:a.documents[0],target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),className:"flex items-center gap-1 text-[10px] text-primary hover:underline",children:[(0,b.jsx)(p,{className:"w-3 h-3"}),"Proof (",a.documents.length,")"]})]})]},a.id)})})})]}),(0,b.jsxs)(w.Card,{className:"flex-1 flex flex-col overflow-hidden shadow-card border-none bg-card min-h-0",children:[(0,b.jsx)("div",{className:"p-4 border-b border-border bg-muted/30",children:(0,b.jsxs)("h2",{className:"font-semibold flex items-center gap-2",children:[(0,b.jsx)(i,{className:"w-4 h-4"})," Segmented Farms (",F.length,")"]})}),(0,b.jsx)(v.ScrollArea,{className:"flex-1 p-4",children:(0,b.jsx)("div",{className:"space-y-3",children:0===F.length?(0,b.jsx)("div",{className:"text-center py-10 text-muted-foreground text-sm",children:"No farms segmented yet. Click on the map to start."}):F.map(a=>(0,b.jsxs)("div",{onClick:()=>I(a.id||null),className:`p-3 rounded-lg border transition-all cursor-pointer hover:shadow-md ${H===a.id?"bg-primary/5 border-primary shadow-sm":"bg-background border-border"}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color}}),(0,b.jsx)("span",{className:"font-medium text-sm",children:a.farmerName})]}),(0,b.jsx)(q.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-destructive",onClick:b=>ad(b,a.id),children:(0,b.jsx)(j.Trash2,{className:"w-3 h-3"})})]}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:a.id}),(0,b.jsxs)("span",{children:[(247105e-9*a.features[0].properties.area_m2).toFixed(2)," ac"]})]})]},a.id))})})]})]}),(0,b.jsxs)("div",{className:"lg:col-span-2 flex flex-col gap-4 h-[calc(100vh-140px)]",children:[(0,b.jsxs)("div",{className:"flex-1 bg-card rounded-2xl shadow-card overflow-hidden border border-border relative",children:[aa?(0,b.jsxs)(s.GoogleMap,{mapContainerStyle:E,center:D,zoom:16,onLoad:ac,onClick:ab,options:{mapTypeId:"hybrid",draggableCursor:"crosshair",clickableIcons:!1,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,zoomControl:!0},children:[F.map(a=>{let c=a.features[0].geometry.coordinates[0].map(a=>({lat:a[1],lng:a[0]}));return(0,b.jsx)(s.Polygon,{paths:c,options:{strokeColor:H===a.id?"#ffffff":a.color,strokeOpacity:1,strokeWeight:H===a.id?3:2,fillColor:a.color,fillOpacity:H===a.id?.6:.4,zIndex:H===a.id?10:1},onClick:()=>I(a.id||null),onMouseOver:b=>{b.latLng&&(T(a),V({lat:b.latLng.lat(),lng:b.latLng.lng()}))},onMouseOut:()=>{T(null),V(null)}},a.id)}),S&&U&&(0,b.jsx)(s.InfoWindow,{position:U,onCloseClick:()=>T(null),options:{disableAutoPan:!0},children:(0,b.jsxs)("div",{className:"p-2 min-w-[200px] bg-white text-black rounded-lg shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-gray-200",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:S.color}}),(0,b.jsx)("h3",{className:"font-bold text-sm text-black",children:S.farmerName})]}),(0,b.jsxs)("div",{className:"space-y-1 text-xs text-slate-700",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"font-semibold text-slate-500",children:"Crop:"}),(0,b.jsx)("span",{children:S.cropType})]}),(0,b.jsxs)("div",{className:"flex justify-between border-t border-gray-100 pt-1 mt-1",children:[(0,b.jsx)("span",{className:"font-semibold text-slate-500",children:"Area:"}),(0,b.jsxs)("span",{className:"font-bold text-black",children:[(247105e-9*S.features[0].properties.area_m2).toFixed(2)," ac"]})]})]})]})}),W&&(0,b.jsx)(s.Marker,{position:W,title:R?.farmerName||"Farm Location",icon:{url:"https://maps.google.com/mapfiles/ms/icons/red-dot.png",scaledSize:new google.maps.Size(40,40)}})]}):(0,b.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,b.jsx)(f.Loader2,{className:"w-8 h-8 animate-spin text-muted-foreground"})}),J&&(0,b.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-10 transition-all",children:(0,b.jsxs)("div",{className:"bg-card rounded-lg p-6 flex items-center gap-4 shadow-xl",children:[(0,b.jsx)(f.Loader2,{className:"w-6 h-6 animate-spin text-primary"}),(0,b.jsx)("span",{className:"text-foreground font-medium",children:"Segmenting Farm Area..."})]})})]}),(0,b.jsxs)("div",{className:"h-24 bg-card rounded-2xl shadow-card p-4 flex items-center justify-between border border-border relative overflow-hidden group",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500/10 via-emerald-500/5 to-emerald-500/10 animate-gradient-x"}),(0,b.jsxs)("div",{className:"relative z-10",children:[(0,b.jsxs)("h3",{className:"font-bold text-lg flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"flex h-3 w-3 relative",children:[(0,b.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),(0,b.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-emerald-500"})]}),"AI Yield Analysis"]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:ae()?`Analysis ready for ${ae()?.farmerName}`:"Generate predictive insights for this season based on satellite data."})]}),(0,b.jsx)(q.Button,{size:"lg",className:"relative z-10 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white font-bold shadow-lg shadow-emerald-500/20 transition-all hover:scale-105 active:scale-95 border-0",disabled:!H||Y,onClick:()=>{if(!H)return;let b=ae();if(!b)return;let c=new URLSearchParams;c.set("farmId",H),b.claimId&&c.set("claimId",b.claimId),a.push(`/officer/yield-predict?${c.toString()}`)},children:Y?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Analyzing..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"mr-2",children:"✨"}),ae()?"Predict Yield":"Select a Farm"]})})]})]}),(0,b.jsx)("div",{className:"lg:col-span-1 flex flex-col gap-4",children:(0,b.jsxs)(w.Card,{className:"flex-1 shadow-card border-none bg-card overflow-hidden flex flex-col",children:[(0,b.jsx)("div",{className:"p-4 border-b border-border bg-muted/30",children:(0,b.jsxs)("h2",{className:"font-semibold flex items-center gap-2",children:[(0,b.jsx)(k.Eye,{className:"w-4 h-4"})," Selected Farm Details"]})}),H&&ae()?(0,b.jsxs)("div",{className:"p-4 space-y-6 flex-1 overflow-auto",children:[(0,b.jsx)("div",{className:"aspect-video bg-muted/20 rounded-lg flex items-center justify-center border border-border/50",children:(0,b.jsx)("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid meet",className:"w-full h-full p-4",children:(a=>{if(!a.features?.[0]?.geometry?.coordinates)return null;let c=a.features[0].geometry.coordinates[0],d=c.map(a=>a[0]),e=c.map(a=>a[1]),f=Math.min(...d),g=Math.min(...e),h=Math.max(...e),i=Math.max(...d)-f,j=h-g,k=Math.max(i,j)||1,l=(100-i/k*100)/2,m=(100-j/k*100)/2,n=c.map(a=>{let b=l+(a[0]-f)/k*100,c=m+(h-a[1])/k*100;return`${b},${c}`}).join(" ");return(0,b.jsx)("polygon",{points:n,fill:a.color,fillOpacity:.6,stroke:"#fff",strokeWidth:"1"})})(ae())})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wider font-semibold",children:"Farm ID"}),(0,b.jsx)("p",{className:"text-lg font-mono text-foreground",children:ae()?.id})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wider font-semibold",children:"Area (m²)"}),(0,b.jsx)("p",{className:"text-xl font-bold text-primary",children:ae()?.features[0].properties.area_m2?.toFixed(2)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wider font-semibold",children:"Area (Acres)"}),(0,b.jsx)("p",{className:"text-xl font-bold text-primary",children:(247105e-9*ae().features[0].properties.area_m2).toFixed(2)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 bg-muted/20 p-3 rounded-lg border border-border/50",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-[10px] text-muted-foreground uppercase tracking-wider font-semibold",children:"Farmer"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:ae()?.farmerName})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-[10px] text-muted-foreground uppercase tracking-wider font-semibold",children:"Crop"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:ae()?.cropType})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-[10px] text-muted-foreground uppercase tracking-wider font-semibold",children:"Village"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:ae()?.village})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-[10px] text-muted-foreground uppercase tracking-wider font-semibold",children:"Survey No"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:ae()?.surveyNo})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wider font-semibold",children:"Status"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Verified Segment"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wider font-semibold",children:"Coordinates"}),(0,b.jsx)(v.ScrollArea,{className:"h-32 w-full rounded-md border border-border bg-muted/50 p-2 mt-1",children:(0,b.jsx)("pre",{className:"text-[10px] text-muted-foreground",children:JSON.stringify(ae()?.features[0].geometry.coordinates,null,2)})})]})]})]}):(0,b.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center text-muted-foreground",children:[(0,b.jsx)(g.MapPin,{className:"w-12 h-12 mb-4 opacity-20"}),(0,b.jsx)("p",{children:"Select a farm segment from the list or map to view details"})]})]})})]})]})]})}a.s(["default",()=>F],877565)}];

//# sourceMappingURL=src_pages_officer_OfficerClaimAnalysis_tsx_df724f75._.js.map