(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,531278,e=>{"use strict";let t=(0,e.i(475254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],531278)},789115,623385,e=>{"use strict";var t=e.i(843476),a=e.i(525883),r=e.i(260289),s=e.i(178583),l=e.i(217923),i=e.i(475254);let n=(0,i.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),o=(0,i.default)("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),c=(0,i.default)("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);e.s(["BrainCircuit",()=>c],623385);let d=[{title:"Dashboard",url:"/officer",icon:r.LayoutDashboard},{title:"Approvals",url:"/officer/approvals",icon:s.FileText},{title:"Claims Monitoring",url:"/officer/claims",icon:s.FileText},{title:"Claim Analysis",url:"/officer/analysis",icon:o},{title:"Analytics",url:"/officer/analytics",icon:l.BarChart3},{title:"AI Yield Predict",url:"/officer/yield-predict",icon:c},{title:"Settings",url:"/officer/settings",icon:n}];function u(){return(0,t.jsx)("aside",{className:"w-64 min-h-screen bg-card border-r border-border shadow-sidebar",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-8",children:[(0,t.jsx)("img",{src:"/logo.png",alt:"YES-TECH",className:"w-10 h-10 rounded-xl object-contain"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-display font-bold text-foreground",children:"YES-TECH"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Agri Monitor"})]})]}),(0,t.jsx)("nav",{className:"space-y-1",children:d.map(e=>(0,t.jsxs)(a.NavLink,{to:e.url,end:"/officer"===e.url,className:"flex items-center gap-3 px-4 py-3 rounded-lg text-muted-foreground hover:bg-secondary hover:text-foreground transition-all duration-200",activeClassName:"bg-primary/10 text-primary font-medium",children:[(0,t.jsx)(e.icon,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:e.title})]},e.title))})]})})}e.s(["OfficerSidebar",()=>u],789115)},63209,e=>{"use strict";let t=(0,e.i(475254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},793479,e=>{"use strict";var t=e.i(843476),a=e.i(271645),r=e.i(975157);let s=a.forwardRef(({className:e,type:a,...s},l)=>(0,t.jsx)("input",{type:a,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:l,...s}));s.displayName="Input",e.s(["Input",()=>s])},110204,e=>{"use strict";var t=e.i(843476),a=e.i(271645),r=e.i(248425),s=a.forwardRef((e,a)=>(0,t.jsx)(r.Primitive.label,{...e,ref:a,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));s.displayName="Label";var l=e.i(225913),i=e.i(975157);let n=(0,l.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)(s,{ref:r,className:(0,i.cn)(n(),e),...a}));o.displayName=s.displayName,e.s(["Label",()=>o],110204)},232189,(e,t,a)=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},865156,(e,t,a)=>{"use strict";var r=e.r(232189);function s(){}function l(){}l.resetWarningCache=s,t.exports=function(){function e(e,t,a,s,l,i){if(i!==r){var n=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw n.name="Invariant Violation",n}}function t(){return e}e.isRequired=e;var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:l,resetWarningCache:s};return a.PropTypes=a,a}},745009,(e,t,a)=>{t.exports=e.r(865156)()},826633,e=>{"use strict";e.i(436180);var t=e.i(98925),a=e.i(959141);async function r(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}function s(){if(!a.db)throw Error("Firebase is not configured. Please set up your .env.local file with Firebase credentials. Copy .env.example to .env.local and add your Firebase config.");return a.db}async function l(){let e=new Date().getFullYear(),a=(0,t.query)((0,t.collection)(s(),"claims"),(0,t.orderBy)("createdAt","desc")),r=(await (0,t.getDocs)(a)).size+1;return`CLM-${e}-${String(r).padStart(4,"0")}`}async function i(e){let a=await l();return(await (0,t.addDoc)((0,t.collection)(s(),"claims"),{...e,claimNumber:a,status:e.status||"pending",createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()})).id}async function n(e){let a=await (0,t.getDoc)((0,t.doc)(s(),"claims",e));return a.exists()?{id:e,...a.data()}:null}async function o(){let e=(0,t.query)((0,t.collection)(s(),"claims"),(0,t.orderBy)("createdAt","desc"));return(await (0,t.getDocs)(e)).docs.map(e=>({id:e.id,...e.data()}))}async function c(e,a,r,l){await (0,t.updateDoc)((0,t.doc)(s(),"claims",e),{status:a,officerNotes:r,processedBy:l,processedAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()})}async function d(e,a,r){await (0,t.updateDoc)((0,t.doc)(s(),"claims",e),{blockchainTxHash:a,blockchainExplorerUrl:r,updatedAt:(0,t.serverTimestamp)()})}async function u(e){let a={...e,featuresJson:JSON.stringify(e.features),features:void 0,createdAt:(0,t.serverTimestamp)()};return delete a.features,(await (0,t.addDoc)((0,t.collection)(s(),"segmentedFarms"),a)).id}async function m(){let e=(0,t.query)((0,t.collection)(s(),"segmentedFarms"),(0,t.orderBy)("createdAt","desc"));return(await (0,t.getDocs)(e)).docs.map(e=>{let t=e.data(),a=t.featuresJson?JSON.parse(t.featuresJson):[];return{id:e.id,...t,features:a}})}async function h(e){let a=await (0,t.getDoc)((0,t.doc)(s(),"segmentedFarms",e));if(a.exists()){let t=a.data(),r=t.featuresJson?JSON.parse(t.featuresJson):[];return{id:e,...t,features:r}}return null}async function p(e){await (0,t.deleteDoc)((0,t.doc)(s(),"segmentedFarms",e))}async function f(e){let a,l=await (0,t.addDoc)((0,t.collection)(s(),"reports"),{...e,createdAt:(0,t.serverTimestamp)()});if(e.claimId){let i=`${e.pdfUrl}-${Date.now()}`;a=await r(i),await (0,t.updateDoc)((0,t.doc)(s(),"claims",e.claimId),{reportId:l.id,reportUrl:e.pdfUrl,status:"waiting",reportGeneratedAt:(0,t.serverTimestamp)(),blockchainHash:a,updatedAt:(0,t.serverTimestamp)()})}return{reportId:l.id,blockchainHash:a}}function x(e,a,r){let l=[(0,t.where)("status","==",e)],i=(0,t.query)((0,t.collection)(s(),"claims"),...l);return(0,t.onSnapshot)(i,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));t.sort((e,t)=>{let a=e.createdAt?.toMillis()||0;return(t.createdAt?.toMillis()||0)-a}),r&&r>0&&(t=t.slice(0,r)),a(t)})}e.s(["createClaim",()=>i,"deleteSegmentedFarm",()=>p,"getAllClaims",()=>o,"getClaim",()=>n,"getSegmentedFarmById",()=>h,"getSegmentedFarms",()=>m,"saveReport",()=>f,"saveSegmentedFarm",()=>u,"subscribeToClaimsByStatus",()=>x,"updateClaimBlockchainInfo",()=>d,"updateClaimStatus",()=>c],826633)},514764,e=>{"use strict";let t=(0,e.i(475254).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],514764)},103053,e=>{"use strict";e.i(961086);var t=e.i(527215),a=e.i(959141);function r(){if(!a.storage)throw Error("Firebase Storage is not configured. Please set up your .env.local file with Firebase credentials. Copy .env.example to .env.local and add your Firebase config.");return a.storage}async function s(e,a,s){let l=(0,t.ref)(r(),a);if(!s)return await (0,t.uploadBytes)(l,e),(0,t.getDownloadURL)(l);{let a=(0,t.uploadBytesResumable)(l,e);return new Promise((e,r)=>{a.on("state_changed",e=>{s(e.bytesTransferred/e.totalBytes*100)},e=>{r(e)},async()=>{e(await (0,t.getDownloadURL)(a.snapshot.ref))})})}}async function l(e,t,a,r){let l=Date.now(),i=e.name.replace(/[^a-zA-Z0-9.-]/g,"_");return s(e,a?`documents/${t}/${a}/${l}_${i}`:`documents/${t}/${l}_${i}`,r)}async function i(e,a,s){let l=Date.now(),i=s.replace(/[^a-zA-Z0-9.-]/g,"_"),n=`reports/${a}/${l}_${i}`,o=(0,t.ref)(r(),n);return await (0,t.uploadBytes)(o,e),(0,t.getDownloadURL)(o)}e.s(["uploadDocument",()=>l,"uploadReportPDF",()=>i])},595468,e=>{"use strict";let t=(0,e.i(475254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],595468)},624687,e=>{"use strict";var t=e.i(843476),a=e.i(271645),r=e.i(975157);let s=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...a}));s.displayName="Textarea",e.s(["Textarea",()=>s])},283086,88653,357772,e=>{"use strict";let t=(0,e.i(475254).default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);e.s(["Sparkles",()=>t],283086),e.i(247167);var a=e.i(843476),r=e.i(271645),s=e.i(231178),l=e.i(947414),i=e.i(674008),n=e.i(821476),o=e.i(772846),c=r,d=e.i(737806);function u(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class m extends c.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,a=(0,o.isHTMLElement)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=a-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function h({children:e,isPresent:t,anchorX:s,root:l}){let i=(0,c.useId)(),n=(0,c.useRef)(null),o=(0,c.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:h}=(0,c.useContext)(d.MotionConfigContext),p=function(...e){return r.useCallback(function(...e){return t=>{let a=!1,r=e.map(e=>{let r=u(e,t);return a||"function"!=typeof r||(a=!0),r});if(a)return()=>{for(let t=0;t<r.length;t++){let a=r[t];"function"==typeof a?a():u(e[t],null)}}}}(...e),e)}(n,e?.ref);return(0,c.useInsertionEffect)(()=>{let{width:e,height:a,top:r,left:c,right:d}=o.current;if(t||!n.current||!e||!a)return;let u="left"===s?`left: ${c}`:`right: ${d}`;n.current.dataset.motionPopId=i;let m=document.createElement("style");h&&(m.nonce=h);let p=l??document.head;return p.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            ${u}px !important;
            top: ${r}px !important;
          }
        `),()=>{p.contains(m)&&p.removeChild(m)}},[t]),(0,a.jsx)(m,{isPresent:t,childRef:n,sizeRef:o,children:c.cloneElement(e,{ref:p})})}let p=({children:e,initial:t,isPresent:s,onExitComplete:i,custom:o,presenceAffectsLayout:c,mode:d,anchorX:u,root:m})=>{let p=(0,l.useConstant)(f),x=(0,r.useId)(),g=!0,y=(0,r.useMemo)(()=>(g=!1,{id:x,initial:t,isPresent:s,custom:o,onExitComplete:e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;i&&i()},register:e=>(p.set(e,!1),()=>p.delete(e))}),[s,p,i]);return c&&g&&(y={...y}),(0,r.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[s]),r.useEffect(()=>{s||p.size||!i||i()},[s]),"popLayout"===d&&(e=(0,a.jsx)(h,{isPresent:s,anchorX:u,root:m,children:e})),(0,a.jsx)(n.PresenceContext.Provider,{value:y,children:e})};function f(){return new Map}var x=e.i(464978);let g=e=>e.key||"";function y(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let v=({children:e,custom:t,initial:n=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:u=!1,anchorX:m="left",root:h})=>{let[f,v]=(0,x.usePresence)(u),b=(0,r.useMemo)(()=>y(e),[e]),j=u&&!f?[]:b.map(g),N=(0,r.useRef)(!0),w=(0,r.useRef)(b),S=(0,l.useConstant)(()=>new Map),[C,F]=(0,r.useState)(b),[k,D]=(0,r.useState)(b);(0,i.useIsomorphicLayoutEffect)(()=>{N.current=!1,w.current=b;for(let e=0;e<k.length;e++){let t=g(k[e]);j.includes(t)?S.delete(t):!0!==S.get(t)&&S.set(t,!1)}},[k,j.length,j.join("-")]);let A=[];if(b!==C){let e=[...b];for(let t=0;t<k.length;t++){let a=k[t],r=g(a);j.includes(r)||(e.splice(t,0,a),A.push(a))}return"wait"===d&&A.length&&(e=A),D(y(e)),F(b),null}let{forceRender:T}=(0,r.useContext)(s.LayoutGroupContext);return(0,a.jsx)(a.Fragment,{children:k.map(e=>{let r=g(e),s=(!u||!!f)&&(b===k||j.includes(r));return(0,a.jsx)(p,{isPresent:s,initial:(!N.current||!!n)&&void 0,custom:t,presenceAffectsLayout:c,mode:d,root:h,onExitComplete:s?void 0:()=>{if(!S.has(r))return;S.set(r,!0);let e=!0;S.forEach(t=>{t||(e=!1)}),e&&(T?.(),D(w.current),u&&v?.(),o&&o())},anchorX:m,children:e},r)})})};e.s(["AnimatePresence",()=>v],88653);let b=(0,e.i(33550).default)("outline","x","X",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);e.s(["IconX",()=>b],357772)},857415,e=>{"use strict";var t=e.i(843476),a=e.i(789115),r=e.i(519455),s=e.i(793479),l=e.i(110204),i=e.i(624687),n=e.i(967489),o=e.i(111110),c=e.i(557951),d=e.i(178583),u=e.i(514764),m=e.i(531278),h=e.i(915338),p=e.i(283086),f=e.i(63209),x=e.i(595468),g=e.i(271645),y=e.i(846932),v=e.i(88653),b=e.i(888518),j=e.i(357772),N=e.i(826633),w=e.i(103053);e.i(436180);var S=e.i(98925),C=e.i(846696),F=e.i(618566),k=e.i(918657);function D(){let{t:e}=(0,o.useLanguage)(),{user:D,userProfile:A,isConfigured:T}=(0,c.useAuth)(),I=(0,F.useRouter)(),[L,P]=(0,g.useState)(null),[M,R]=(0,g.useState)(!1),[E,O]=(0,g.useState)(!1),[z,U]=(0,g.useState)(null),[$,B]=(0,g.useState)(null),[V,q]=(0,g.useState)(null),[_,H]=(0,g.useState)({farmerId:"",farmerName:"",otherNames:"",village:"",district:"",surveyNo:"",farmCoordinates:"",cropType:"",area:"",policyNumber:"",lossDate:"",lossType:"",cropStage:"",harvestDate:"",description:""}),[W,J]=(0,g.useState)([]),[Y,G]=(0,g.useState)(null),[X,Z]=(0,g.useState)(!1);(0,g.useEffect)(()=>{$&&G($)},[$]);let K=async e=>{let t=await e.arrayBuffer(),a=await k.getDocument({data:t}).promise,r=a.numPages,s=[];for(let e=1;e<=r;e++){let t=await a.getPage(e),r=t.getViewport({scale:2}),l=document.createElement("canvas"),i=l.getContext("2d");if(!i)throw Error("Could not get canvas context");l.height=r.height,l.width=r.width,await t.render({canvasContext:i,viewport:r,canvas:l}).promise,s.push(l.toDataURL("image/png"))}return s},Q=async()=>{if($){O(!0),U(null),q(null);try{var e;let t,a,r,s,l,i,n,o=[];o="application/pdf"===$.type?await K($):[await new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL($)})];let c="",d=null;for(let e=0;e<o.length;e++){let t=await fetch("/api/ocr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:o[e]})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to extract text")}let a=await t.json();c+=a.text,a.structuredData&&(!d||0===e)&&(d=a.structuredData)}let u=d||(e=c,t=e=>e?.replace(/[:\-\.]/g,"").trim()||"",a=e.match(/गाव\s*[:\-]+\s*(?!नमुना)([^\s\n]+)/)||e.match(/Village\s*[:\-]+\s*([^\s\n]+)/i),r=e.match(/तालुका\s*[:\-]+\s*([^\s\n]+)/)||e.match(/Taluka\s*[:\-]+\s*([^\s\n]+)/i),s=e.match(/जिल्हा\s*[:\-]+\s*([^\s\n]+)/)||e.match(/District\s*[:\-]+\s*([^\s\n]+)/i),l=e.match(/भूमापन\s*क्रमांक\s*[:\-\s]*([\d\w\/]+)/)||e.match(/गट\s*क्रमांक\s*[:\-\s]*([\d\w\/]+)/)||e.match(/Survey\s*No\.?\s*[:\-\s]*([\d\w\/]+)/i),i=e.match(/खातेदारांची\s*नावे\s*[:\-]*\s*([^\n]+)/)||e.match(/खातेदार\s*[:\-]*\s*([^\n]+)/)||e.match(/Name\s*[:\-]*\s*([^\n]+)/i),n=e.match(/एकूण\s*[:\-\s]*([\d\.१२३४५६७८९०]+)/)||e.match(/क्षेत्र\s*[:\-\s]*([\d\.१२३४५६७८९०]+)/)||e.match(/Area\s*[:\-\s]*([\d\.]+)/i),{surveyNumber:t(l?.[1]||""),ownerName:t(i?.[1]||""),village:t(a?.[1]||""),taluka:t(r?.[1]||""),district:t(s?.[1]||""),area:n?.[1]?(e=>{if(!e)return e;let t={"०":"0","१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9"};return e.replace(/[०-९]/g,e=>t[e]||e)})(n[1]):"",coordinates:"Not Found"});q(u);let m=u.area?.replace(/[^\d.]/g,"");H(e=>({...e,otherNames:"Not Found"!==u.ownerName?u.ownerName:e.otherNames,village:"Not Found"!==u.village?u.village:e.village,district:"Not Found"!==u.district?u.district:e.district,surveyNo:"Not Found"!==u.surveyNumber?u.surveyNumber:e.surveyNo,area:m||e.area,description:`${e.description}

Auto-detected from 7/12:
Survey No: ${u.surveyNumber}
Coordinates: ${u.coordinates||"Not Found"}`.trim()})),C.toast.success("Document analyzed & form auto-filled!")}catch(e){console.error("Analysis Error:",e),U(e.message||"Failed to analyze document"),C.toast.error("Analysis failed")}finally{O(!1)}}},ee=async e=>{if(e.preventDefault(),console.log("Auth State:",{user:D?.uid,isConfigured:T,userProfile:A}),!D?.uid||!T)return void C.toast.error((0,t.jsxs)("div",{children:["Please ",(0,t.jsx)("a",{href:"/login",className:"underline font-bold",children:"log in"})," to submit a claim"]}));if(!_.farmerId||!_.farmerName||!_.lossType||!_.cropStage||!_.lossDate)return void C.toast.error("Please fill in all required fields");try{let e,t,a;R(!0);let r=[];for(let e of W){let t=await (0,w.uploadDocument)(e,D.uid);r.push(t)}if(Y&&(e=await (0,w.uploadDocument)(Y,D.uid)),_.farmCoordinates){let e=_.farmCoordinates.split(",").map(e=>parseFloat(e.trim()));2!==e.length||isNaN(e[0])||isNaN(e[1])||(t=e[0],a=e[1])}let s={farmerId:_.farmerId,farmerName:_.farmerName,userId:D.uid,filedBy:"officer",village:_.village,district:_.district||A?.district||"",surveyNumber:_.surveyNo||"",cropType:_.cropType||"Rice",area:parseFloat(_.area)||0,areaUnit:"acres",policyNumber:_.policyNumber||"",lossType:_.lossType,lossDate:S.Timestamp.fromDate(new Date(_.lossDate)),cropStage:_.cropStage,description:_.description||"",amount:0,status:"pending",documents:r,document712Url:e||""};void 0!==t&&(s.latitude=t),void 0!==a&&(s.longitude=a),_.harvestDate&&(s.harvestDate=S.Timestamp.fromDate(new Date(_.harvestDate))),await (0,N.createClaim)(s),C.toast.success("Claim filed successfully!"),I.push("/officer/claims")}catch(e){console.error("Error submitting claim:",e),C.toast.error(e.message||"Failed to submit claim")}finally{R(!1)}};return(0,t.jsxs)("div",{className:"flex min-h-screen bg-background",children:[(0,t.jsx)(a.OfficerSidebar,{}),(0,t.jsx)("main",{className:"flex-1 p-2 overflow-auto",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 max-w-[1800px] items-start",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-foreground font-display",children:"File New Claim"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"AI-Assisted Claim Filing Process"})]}),(0,t.jsxs)("div",{className:"bg-card rounded-xl border border-border shadow-sm p-5 h-fit",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,t.jsx)(p.Sparkles,{className:"w-5 h-5 text-primary"}),"1. Upload 7/12 for Analysis"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload the 7/12 document extract. Our AI will analyze it to auto-fill the claim form details."}),(0,t.jsx)("div",{className:"w-full border border-dashed bg-muted/30 border-border rounded-lg overflow-hidden min-h-[200px] mb-4",children:(0,t.jsx)(b.FileUpload,{onChange:e=>{e?.[0]&&(B(e[0]),q(null),U(null))}})}),z&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg flex items-start gap-2 text-red-600 text-sm",children:[(0,t.jsx)(f.AlertCircle,{className:"w-4 h-4 mt-0.5"}),(0,t.jsx)("span",{children:z})]}),(0,t.jsx)(r.Button,{onClick:Q,disabled:!$||E,className:"w-full gap-2",size:"lg",children:E?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Loader2,{className:"w-5 h-5 animate-spin"}),"Analyzing Document..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Scan,{className:"w-5 h-5"}),"Analyze & Auto-Fill"]})}),V&&(0,t.jsxs)("div",{className:"mt-4 p-4 bg-green-500/10 border border-green-500/20 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-green-700 font-medium mb-2",children:[(0,t.jsx)(x.CheckCircle2,{className:"w-5 h-5"}),"Analysis Complete"]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Owner:"})," ",V.ownerName]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Village:"})," ",V.village]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Area:"})," ",V.area]}),(0,t.jsx)("p",{className:"text-xs mt-2 text-green-600",children:"Form fields have been auto-filled."})]})]})]}),(0,t.jsxs)("div",{className:"bg-card rounded-xl border border-border shadow-sm p-5 h-fit",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Proof Upload (Geotag Photos)"}),(0,t.jsx)("div",{className:"w-full border border-dashed bg-muted/30 border-border rounded-lg overflow-hidden min-h-[120px]",children:(0,t.jsx)(b.FileUpload,{onChange:e=>J(e),onPreview:P})}),W.length>0&&(0,t.jsx)("div",{className:"mt-3 grid grid-cols-3 gap-2",children:W.map((e,a)=>(0,t.jsxs)("div",{className:"relative group aspect-square rounded-lg overflow-hidden border border-border bg-muted/20",children:[e.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-full object-cover cursor-pointer hover:opacity-80 transition",onClick:()=>P(e)}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(d.FileText,{className:"w-8 h-8 text-muted-foreground"})}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] px-1 py-0.5 truncate",children:e.name})]},a))}),(0,t.jsx)(r.Button,{onClick:async()=>{if(0===W.length)return void C.toast.error("Please upload an image first");Z(!0);try{for(let e of W)if(e.type.startsWith("image/")){let t=await new Promise(t=>{let a=new FileReader;a.onloadend=()=>t(a.result),a.readAsDataURL(e)}),a=await fetch("/api/ocr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:t})});if(a.ok){let e=await a.json(),t=e.text||"";if(console.log("OCR Text:",t),console.log("Structured Data:",e.structuredData),e.structuredData?.coordinates&&"Not Found"!==e.structuredData.coordinates){let t=e.structuredData.coordinates.match(/(-?\d+\.?\d*)[°\s,]+(-?\d+\.?\d*)/);if(t){let e=parseFloat(t[1]),a=parseFloat(t[2]);if(!isNaN(e)&&!isNaN(a)){let t=`${e.toFixed(6)}, ${a.toFixed(6)}`;H(e=>({...e,farmCoordinates:t})),C.toast.success("Coordinates extracted!",{description:t}),Z(!1);return}}}for(let e of[/Lat\s*(-?\d+\.?\d*)°?\s*Long\s*(-?\d+\.?\d*)°?/i,/(-?\d{1,3}\.\d{2,})\s*°?\s*[,\s]+\s*(-?\d{1,3}\.\d{2,})\s*°?/,/lat[itude]*\s*[:=]?\s*(-?\d+\.?\d*)\s*[°,\s]+long[itude]*\s*[:=]?\s*(-?\d+\.?\d*)/i,/[NS]\s*(-?\d+\.?\d*)\s*[,\s]+[EW]\s*(-?\d+\.?\d*)/i]){let a=t.match(e);if(a){console.log("Regex matched:",e,a);let t=parseFloat(a[1]),r=parseFloat(a[2]);if(!isNaN(t)&&!isNaN(r)&&90>=Math.abs(t)&&180>=Math.abs(r)){let e=`${t.toFixed(6)}, ${r.toFixed(6)}`;H(t=>({...t,farmCoordinates:e})),C.toast.success("Coordinates extracted!",{description:e}),Z(!1);return}}}}}C.toast.error("No coordinates found in images")}catch(e){console.error("OCR extraction failed:",e),C.toast.error("Failed to extract coordinates")}Z(!1)},disabled:0===W.length||X,className:"w-full mt-3 gap-2",variant:"outline",children:X?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Loader2,{className:"w-4 h-4 animate-spin"}),"Extracting Coordinates..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Scan,{className:"w-4 h-4"}),"Extract Coordinates from Image"]})})]})]}),(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"bg-card rounded-xl border border-border shadow-sm p-4 md:p-5 h-fit",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"2. Claim Application Form"}),(0,t.jsxs)("form",{className:"space-y-3",onSubmit:ee,children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"farmer-id",children:"Farmer ID *"}),(0,t.jsx)(s.Input,{id:"farmer-id",placeholder:"Enter Farmer ID",className:"h-9",value:_.farmerId,onChange:e=>H({..._,farmerId:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"other-names",children:"Owner Names (from 7/12)"}),(0,t.jsx)(s.Input,{id:"other-names",placeholder:"Extracted names...",className:"h-9 bg-muted/20",value:_.otherNames,readOnly:!0})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"farmer-name",children:"Farmer Name (Manual Entry) *"}),(0,t.jsx)(s.Input,{id:"farmer-name",placeholder:"Enter Farmer Name",className:"h-9",value:_.farmerName,onChange:e=>H({..._,farmerName:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"village",children:"Village"}),(0,t.jsx)(s.Input,{id:"village",placeholder:"Village (Auto-filled)",className:"h-9 bg-muted/20",value:_.village,onChange:e=>H({..._,village:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"district",children:"District"}),(0,t.jsx)(s.Input,{id:"district",placeholder:"District (Auto-filled)",className:"h-9 bg-muted/20",value:_.district,onChange:e=>H({..._,district:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"survey-no",children:"Survey / Gat No"}),(0,t.jsx)(s.Input,{id:"survey-no",placeholder:"Survey No (Auto-filled)",className:"h-9 bg-muted/20",value:_.surveyNo,onChange:e=>H({..._,surveyNo:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"crop-type",children:"Crop Type"}),(0,t.jsxs)(n.Select,{value:_.cropType,onValueChange:e=>H({..._,cropType:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"crop-type",className:"h-9",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select Crop"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"Rice",children:"Rice"}),(0,t.jsx)(n.SelectItem,{value:"Wheat",children:"Wheat"}),(0,t.jsx)(n.SelectItem,{value:"Cotton",children:"Cotton"}),(0,t.jsx)(n.SelectItem,{value:"Sugarcane",children:"Sugarcane"}),(0,t.jsx)(n.SelectItem,{value:"Maize",children:"Maize"}),(0,t.jsx)(n.SelectItem,{value:"Onion",children:"Onion"}),(0,t.jsx)(n.SelectItem,{value:"Grape",children:"Grape"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"area",children:"Area (Acres)"}),(0,t.jsx)(s.Input,{id:"area",type:"text",placeholder:"Area (Auto-filled)",className:"h-9 bg-muted/20",value:_.area,onChange:e=>H({..._,area:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"policy-number",children:"Policy Number"}),(0,t.jsxs)(n.Select,{value:_.policyNumber,onValueChange:e=>H({..._,policyNumber:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"policy-number",className:"h-9",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select Policy"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"PMFBY-2023-001",children:"PMFBY-2023-001 (Rice)"}),(0,t.jsx)(n.SelectItem,{value:"PMFBY-2023-002",children:"PMFBY-2023-002 (Wheat)"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"loss-date",children:"Date of Loss *"}),(0,t.jsx)(s.Input,{type:"date",id:"loss-date",className:"h-9",value:_.lossDate,onChange:e=>H({..._,lossDate:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"loss-type",children:"Type of Loss *"}),(0,t.jsxs)(n.Select,{value:_.lossType,onValueChange:e=>H({..._,lossType:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"loss-type",className:"h-9",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select Loss Type"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"drought",children:"Drought"}),(0,t.jsx)(n.SelectItem,{value:"flood",children:"Flood / Excess Rain"}),(0,t.jsx)(n.SelectItem,{value:"pest",children:"Pest Attack"}),(0,t.jsx)(n.SelectItem,{value:"fire",children:"Fire"}),(0,t.jsx)(n.SelectItem,{value:"landslide",children:"Landslide"}),(0,t.jsx)(n.SelectItem,{value:"hailstorm",children:"Hailstorm"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"crop-stage",children:"Crop Stage *"}),(0,t.jsxs)(n.Select,{value:_.cropStage,onValueChange:e=>H({..._,cropStage:e}),children:[(0,t.jsx)(n.SelectTrigger,{id:"crop-stage",className:"h-9",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select Stage"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"sowing",children:"Sowing / Planting"}),(0,t.jsx)(n.SelectItem,{value:"vegetative",children:"Vegetative Growth"}),(0,t.jsx)(n.SelectItem,{value:"flowering",children:"Flowering"}),(0,t.jsx)(n.SelectItem,{value:"maturity",children:"Maturity / Harvesting"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"harvest-date",children:"Date of Harvest (Optional)"}),(0,t.jsx)(s.Input,{type:"date",id:"harvest-date",className:"h-9",value:_.harvestDate,onChange:e=>H({..._,harvestDate:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(l.Label,{htmlFor:"farm-coordinates",children:"Farm Coordinates"}),(0,t.jsx)(s.Input,{id:"farm-coordinates",placeholder:"e.g. 19.0760, 72.8777",className:"h-9",value:_.farmCoordinates,onChange:e=>H({..._,farmCoordinates:e.target.value})})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5 pt-2",children:[(0,t.jsx)(l.Label,{htmlFor:"description",children:"Description of Loss"}),(0,t.jsx)(i.Textarea,{id:"description",placeholder:"Describe how the damage occurred... (Auto-filled with additional data)",className:"min-h-[100px] resize-none",value:_.description,onChange:e=>H({..._,description:e.target.value})})]}),(0,t.jsxs)("div",{className:"pt-4 flex justify-end gap-3",children:[(0,t.jsx)(r.Button,{variant:"outline",type:"button",size:"sm",onClick:()=>I.push("/officer/claims"),children:"Cancel"}),(0,t.jsx)(r.Button,{type:"submit",className:"gap-2",size:"sm",disabled:M||!T,children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Loader2,{className:"w-4 h-4 animate-spin"}),"Submitting..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Send,{className:"w-4 h-4"}),"Submit Claim"]})})]})]})]})})]})}),(0,t.jsx)(v.AnimatePresence,{children:L&&(0,t.jsx)(y.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:()=>P(null),children:(0,t.jsxs)(y.motion.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative bg-white dark:bg-neutral-900 rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:()=>P(null),className:"absolute top-4 right-4 p-2 rounded-full bg-black/10 hover:bg-black/20 dark:bg-white/10 dark:hover:bg-white/20 transition-colors z-10",children:(0,t.jsx)(j.IconX,{className:"w-5 h-5"})}),(0,t.jsx)("div",{className:"p-2 h-full flex items-center justify-center bg-neutral-100 dark:bg-neutral-950",children:L.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(L),alt:"Preview",className:"max-w-full max-h-[80vh] object-contain rounded-md"}):(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 p-12",children:[(0,t.jsx)(d.FileText,{className:"w-16 h-16 text-neutral-400"}),(0,t.jsx)("p",{className:"text-lg font-medium text-neutral-700 dark:text-neutral-300",children:L.name}),(0,t.jsx)("p",{className:"text-sm text-neutral-500",children:"Preview not available for this file type"})]})})]})})})]})}k.GlobalWorkerOptions.workerSrc="/pdf.worker.min.mjs",e.s(["default",()=>D])}]);